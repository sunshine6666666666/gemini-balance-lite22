# Gemini Balance Lite 22

> ğŸš€ **é‡æ„ç‰ˆæœ¬** - æ™ºèƒ½è´Ÿè½½å‡è¡¡çš„Gemini APIä»£ç†æœåŠ¡ï¼Œä¸“ä¸ºè§£å†³APIé…é¢é™åˆ¶è€Œè®¾è®¡

åŸä½œè€…ï¼š[æŠ€æœ¯çˆ¬çˆ¬è™¾](https://space.bilibili.com/316183842)
é‡æ„ä¼˜åŒ–ï¼š[sunshine6666666666](https://github.com/sunshine6666666666)

## ğŸ¯ é¡¹ç›®çŠ¶æ€

**å½“å‰ç‰ˆæœ¬**: v2.0 (é‡æ„ç‰ˆ)
**å¼€å‘åˆ†æ”¯**: refactor-architecture
**éƒ¨ç½²çŠ¶æ€**: âœ… Previewç¯å¢ƒå·²éƒ¨ç½²
**æµ‹è¯•çŠ¶æ€**: âœ… æœ¬åœ°æµ‹è¯•é€šè¿‡ï¼ŒPreviewæµ‹è¯•å°±ç»ª

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ æ¶æ„å‡çº§
- **ğŸ”§ æ¨¡å—åŒ–æ¶æ„** - åˆ†å±‚è®¾è®¡ï¼ŒèŒè´£åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤
- **ğŸ“ å®Œæ•´æ–‡æ¡£** - JSDocæ³¨é‡Šï¼Œä¸­æ–‡è¯´æ˜ï¼Œå¼€å‘å‹å¥½
- **ğŸ§ª æµ‹è¯•ä½“ç³»** - æœ¬åœ°æµ‹è¯• + Previewç¯å¢ƒæµ‹è¯•
- **ğŸ“Š ç»“æ„åŒ–æ—¥å¿—** - ç”Ÿäº§çº§æ—¥å¿—ç³»ç»Ÿï¼Œä¾¿äºé—®é¢˜å®šä½

### âš¡ æ€§èƒ½ç‰¹æ€§
- **ğŸ¯ æ™ºèƒ½è´Ÿè½½å‡è¡¡** - æ—¶é—´çª—å£è½®è¯¢ç®—æ³•ï¼Œè§£å†³é…é¢é™åˆ¶
- **â±ï¸ 45ç§’è¶…æ—¶æœºåˆ¶** - é€‚åº”å¤§æ•°æ®é‡LLMè¯·æ±‚å¤„ç†
- **ğŸ”„ æ™ºèƒ½æ•…éšœåˆ‡æ¢** - é‡åˆ°é”™è¯¯ç«‹å³åˆ‡æ¢API Key
- **âš¡ é›¶å»¶è¿Ÿåˆ‡æ¢** - ç§»é™¤é‡è¯•å»¶è¿Ÿï¼Œæå‡å“åº”é€Ÿåº¦

### ğŸŒ APIå…¼å®¹æ€§
- **ğŸ”— OpenAIå…¼å®¹** - å®Œæ•´æ”¯æŒOpenAI APIæ ¼å¼
- **ğŸ¨ GeminiåŸç”Ÿ** - æ”¯æŒåŸç”ŸGemini APIæ ¼å¼
- **ğŸ”„ æ ¼å¼è½¬æ¢** - è‡ªåŠ¨è¿›è¡ŒOpenAI â†” Geminiæ ¼å¼è½¬æ¢
- **ğŸ“¡ æµå¼å“åº”** - æ”¯æŒå®æ—¶æ•°æ®æµå¤„ç†

### ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶
- **ğŸ” ç™½åå•éªŒè¯** - å¯ä¿¡API KeyéªŒè¯æœºåˆ¶
- **ğŸ­ API Keyè„±æ•** - æ—¥å¿—ä¸­è‡ªåŠ¨è„±æ•æ˜¾ç¤º
- **ğŸš« è®¿é—®æ§åˆ¶** - é˜²æ­¢é…é¢ç›—ç”¨å’Œæ¶æ„è®¿é—®
- **ğŸ“‹ è¯¦ç»†å®¡è®¡** - å®Œæ•´çš„è®¿é—®æ—¥å¿—è®°å½•

## ğŸ“– é¡¹ç›®ç®€ä»‹

ä¸“ä¸šçš„Gemini APIä»£ç†æœåŠ¡ï¼Œä½¿ç”¨Vercel Edge Functionså®ç°é«˜æ€§èƒ½APIä¸­è½¬ã€‚ç»è¿‡å…¨é¢é‡æ„ï¼Œé‡‡ç”¨æ¨¡å—åŒ–åˆ†å±‚æ¶æ„ï¼Œé€šè¿‡åˆ›æ–°çš„æ—¶é—´çª—å£è½®è¯¢ç®—æ³•å’Œæ™ºèƒ½æ•…éšœåˆ‡æ¢æœºåˆ¶ï¼Œè§£å†³å•API Keyé…é¢é™åˆ¶é—®é¢˜ï¼Œå¤§å¹…æå‡APIå¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚

### ğŸ”„ é‡æ„äº®ç‚¹
- **ä»£ç è´¨é‡æå‡**: æ¶ˆé™¤é‡å¤ä»£ç ï¼Œç»Ÿä¸€æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- **æ¶æ„æ¸…æ™°**: åˆ†å±‚æ¶æ„ï¼ŒèŒè´£åˆ†ç¦»æ˜ç¡®
- **æµ‹è¯•å®Œå–„**: æœ¬åœ°æµ‹è¯• + Previewç¯å¢ƒæµ‹è¯•è¦†ç›–
- **æ–‡æ¡£é½å…¨**: å®Œæ•´çš„å¼€å‘æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

## ğŸ“¦ å¿«é€Ÿéƒ¨ç½²

[![Deploy to Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/sunshine6666666666/gemini-balance-lite22)

### éƒ¨ç½²æ­¥éª¤

1. **ä¸€é”®éƒ¨ç½²**ï¼šç‚¹å‡»ä¸Šæ–¹éƒ¨ç½²æŒ‰é’®
2. **Forkä»“åº“**ï¼šé€‰æ‹©Forkåˆ°ä½ çš„GitHubè´¦æˆ·
3. **é…ç½®é¡¹ç›®**ï¼šVercelä¼šè‡ªåŠ¨æ£€æµ‹é¡¹ç›®é…ç½®
4. **éƒ¨ç½²å®Œæˆ**ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆï¼Œè·å¾—åˆ†é…çš„åŸŸå

### é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå›½å†…ç”¨æˆ·å¿…éœ€ï¼‰

1. åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ è‡ªå®šä¹‰åŸŸå
2. é…ç½®DNSè§£ææŒ‡å‘Vercel

    <details>
    <summary>é…ç½®è‡ªå®šä¹‰åŸŸåè¯¦ç»†æ­¥éª¤ï¼š</summary>

    ![image](/docs/images/5.png)
    </details>

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

### ğŸ¯ è´Ÿè½½å‡è¡¡é…ç½®ï¼ˆæ¨èï¼‰

ä¸ºäº†è§£å†³Cherry Studioç­‰å®¢æˆ·ç«¯å•API Keyé…é¢é™åˆ¶é—®é¢˜ï¼Œå»ºè®®é…ç½®å¤‡ç”¨API Keyæ± ï¼š

**Verceléƒ¨ç½²é…ç½®ï¼š**
1. è¿›å…¥Vercelé¡¹ç›®Dashboard
2. ç‚¹å‡» **Settings** â†’ **Environment Variables**
3. æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

#### ğŸ“‹ å¿…éœ€é…ç½®

**å¤‡ç”¨API Keyæ± ï¼š**
```
Name: BACKUP_API_KEYS
Value: your_api_key_1,your_api_key_2,your_api_key_3,your_api_key_4,your_api_key_5
Environment: Production, Preview, Development (å…¨é€‰)
```

**ğŸ›¡ï¸ å®‰å…¨ç™½åå•ï¼ˆé‡è¦ï¼‰ï¼š**
```
Name: TRUSTED_API_KEYS
Value: your_trusted_key_1,your_trusted_key_2,your_trusted_key_3
Environment: Production, Preview, Development (å…¨é€‰)
```

**æœ¬åœ°å¼€å‘é…ç½®ï¼š**
1. å¤åˆ¶ `.env.sample` ä¸º `.env`
2. å¡«å…¥æ‚¨çš„API Keysï¼š

```bash
cp .env.sample .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å®é™…çš„API Keys
```

### ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶è¯´æ˜

**API Keyç™½åå•ä¿æŠ¤ï¼š**
- **å•ä¸ªAPI Keyè¯·æ±‚**ï¼šç³»ç»Ÿé¦–å…ˆæ£€æŸ¥è¯¥Keyæ˜¯å¦åœ¨`TRUSTED_API_KEYS`ç™½åå•ä¸­
- **ç™½åå•éªŒè¯é€šè¿‡**ï¼šå…è®¸ä½¿ç”¨`BACKUP_API_KEYS`è¿›è¡Œè´Ÿè½½å‡è¡¡
- **ç™½åå•éªŒè¯å¤±è´¥**ï¼šç›´æ¥æ‹’ç»è¯·æ±‚ï¼Œè¿”å›401æœªæˆæƒé”™è¯¯
- **å¤šä¸ªAPI Keyè¯·æ±‚**ï¼šæ­£å¸¸å¤„ç†ï¼Œä¸å¯ç”¨å¤‡ç”¨Keyæ± 

**å®‰å…¨ä¼˜åŠ¿ï¼š**
- ğŸ”’ **é˜²æ­¢é…é¢ç›—ç”¨**ï¼šåªæœ‰å¯ä¿¡ç”¨æˆ·æ‰èƒ½ä½¿ç”¨æ‚¨çš„å¤‡ç”¨Keyæ± 
- ğŸ›¡ï¸ **è®¿é—®æ§åˆ¶**ï¼šæ¶æ„ç”¨æˆ·æ— æ³•é€šè¿‡å‘é€æ— æ•ˆKeyæ¥å…è´¹ä½¿ç”¨æ‚¨çš„é…é¢
- ğŸ“Š **æ¸…æ™°æ—¥å¿—**ï¼šè¯¦ç»†è®°å½•ç™½åå•éªŒè¯è¿‡ç¨‹ï¼Œä¾¿äºç›‘æ§

### ğŸ”§ è´Ÿè½½å‡è¡¡å·¥ä½œåŸç†

- **æ™ºèƒ½æ•…éšœåˆ‡æ¢** â†’ é‡åˆ°é…é¢é™åˆ¶è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªKey
- **æ—¶é—´çª—å£è½®è¯¢** â†’ ç¡®ä¿API Keyä½¿ç”¨å‡åŒ€åˆ†å¸ƒ
- **å®‰å…¨ä¿æŠ¤** â†’ åªæœ‰ç™½åå•Keyæ‰èƒ½è§¦å‘å¤‡ç”¨Keyæ± 

## ğŸ§ª æµ‹è¯•éªŒè¯

### Previewç¯å¢ƒæµ‹è¯•
é¡¹ç›®æä¾›å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œæ”¯æŒPreviewç¯å¢ƒåŠŸèƒ½éªŒè¯ï¼š

```bash
# 1. ç¯å¢ƒæ£€æŸ¥
bash tests/preview/check-environment.sh

# 2. å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èï¼‰
bash tests/preview/quick-preview-test.sh

# 3. å…¨é¢æµ‹è¯•
bash tests/preview/comprehensive-preview-test.sh
```

**æµ‹è¯•è¦†ç›–**:
- âœ… APIåŠŸèƒ½æµ‹è¯•ï¼ˆGeminiåŸç”Ÿ + OpenAIå…¼å®¹ï¼‰
- âœ… è´Ÿè½½å‡è¡¡éªŒè¯
- âœ… å®‰å…¨æœºåˆ¶æµ‹è¯•
- âœ… é”™è¯¯å¤„ç†éªŒè¯
- âœ… Gemini 2.5æ€è€ƒæœºåˆ¶æµ‹è¯•

**è¯¦ç»†æŒ‡å—**: å‚è§ `tests/preview/README.md`

### æœ¬åœ°å¼€å‘æµ‹è¯•
```bash
# æœ¬åœ°ç»¼åˆæµ‹è¯•
bash tests/local/comprehensive-test.sh

# æ—¥å¿—éªŒè¯æµ‹è¯•
bash tests/local/log-validation-test.sh
```

## ğŸ› ï¸ æœ¬åœ°å¼€å‘

### ç¯å¢ƒè¦æ±‚
- Node.js 16+
- Vercel CLI
- Git Bash (Windows) æˆ– Terminal (macOS/Linux)

### å¼€å‘æ­¥éª¤
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/sunshine6666666666/gemini-balance-lite22.git
cd gemini-balance-lite22

# 2. åˆ‡æ¢åˆ°é‡æ„åˆ†æ”¯
git checkout refactor-architecture

# 3. å®‰è£…Vercel CLI
npm install -g vercel

# 4. é…ç½®ç¯å¢ƒå˜é‡
cp .env.sample .env.local
# ç¼–è¾‘ .env.local æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„API Keys

# 5. å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
vercel dev

# 6. è¿è¡Œæµ‹è¯•éªŒè¯
bash tests/local/comprehensive-test.sh
```

## ğŸ“– API ä½¿ç”¨è¯´æ˜

### ğŸ”‘ è·å–API Key

1. è®¿é—® [Google AI Studio](https://aistudio.google.com/app/apikey)
2. åˆ›å»ºæ–°çš„API Key
3. å»ºè®®ç”³è¯·å¤šä¸ªAPI Keyä»¥è·å¾—æ›´å¥½çš„è´Ÿè½½å‡è¡¡æ•ˆæœ

### ğŸŒ æ”¯æŒçš„APIæ ¼å¼

#### 1. åŸç”ŸGemini APIæ ¼å¼

**æ ‡å‡†è¯·æ±‚ç¤ºä¾‹ï¼š**
```bash
curl --location 'https://<YOUR_DEPLOYED_DOMAIN>/v1beta/models/gemini-2.5-pro:generateContent' \
--header 'Content-Type: application/json' \
--header 'x-goog-api-key: <YOUR_GEMINI_API_KEY>' \
--data '{
    "contents": [
        {
         "role": "user",
         "parts": [
            {
               "text": "Hello"
            }
         ]
      }
    ]
}'
```

**æµå¼è¯·æ±‚ç¤ºä¾‹ï¼š**
```bash
curl --location 'https://<YOUR_DEPLOYED_DOMAIN>/v1beta/models/gemini-2.5-pro:streamGenerateContent?alt=sse' \
--header 'Content-Type: application/json' \
--header 'x-goog-api-key: <YOUR_GEMINI_API_KEY>' \
--data '{
    "contents": [
        {
         "role": "user",
         "parts": [
            {
               "text": "Hello"
            }
         ]
      }
    ]
}'
```

#### 2. OpenAIå…¼å®¹æ ¼å¼

```bash
curl --location 'https://<YOUR_DEPLOYED_DOMAIN>/chat/completions' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <YOUR_GEMINI_API_KEY>' \
--data '{
    "model": "gemini-2.5-pro",
    "messages": [
        {
            "role": "user",
            "content": "Hello"
        }
    ]
}'
```

### ğŸ” API Key æ ¡éªŒ

```bash
curl --location 'https://<YOUR_DEPLOYED_DOMAIN>/verify' \
--header 'x-goog-api-key: <YOUR_GEMINI_API_KEY_1>,<YOUR_GEMINI_API_KEY_2>'
```

## ğŸ¯ å®¢æˆ·ç«¯é…ç½®

### Cherry Studio é…ç½®ç¤ºä¾‹

<details>
<summary>é…ç½®æˆªå›¾ï¼š</summary>

![image](/docs/images/2.png)
</details>

1. **API Base URL**: `https://your-domain.vercel.app`
2. **API Key**: æ‚¨çš„Gemini API Key
3. **æ¨¡å‹**: `gemini-2.5-pro` æˆ–å…¶ä»–æ”¯æŒçš„æ¨¡å‹

## ğŸ“Š é¡¹ç›®æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£
- **ğŸ“‹ é¡¹ç›®çŠ¶æ€**: [PROJECT_STATUS.md](PROJECT_STATUS.md) - å®Œæ•´çš„é¡¹ç›®çŠ¶æ€æ€»ç»“
- **ğŸ”§ é‡æ„æ–¹æ¡ˆ**: [docs/é‡æ„æ–¹æ¡ˆæ–‡æ¡£.md](docs/é‡æ„æ–¹æ¡ˆæ–‡æ¡£.md) - è¯¦ç»†çš„é‡æ„è®¾è®¡
- **ğŸ§ª æµ‹è¯•æŒ‡å—**: [tests/preview/README.md](tests/preview/README.md) - æµ‹è¯•å¥—ä»¶è¯´æ˜
- **ğŸ” æ—¥å¿—åˆ†æ**: [tests/preview/console-log-analysis.md](tests/preview/console-log-analysis.md) - Console.logè§‚å¯ŸæŒ‡å—

### å¼€å‘æ–‡æ¡£
- **ğŸ—ï¸ æ¶æ„è®¾è®¡**: æ¨¡å—åŒ–åˆ†å±‚æ¶æ„ï¼ŒèŒè´£åˆ†ç¦»
- **ğŸ“ ä»£ç æ³¨é‡Š**: å®Œæ•´çš„JSDocæ³¨é‡Šå’Œä¸­æ–‡è¯´æ˜
- **ğŸ”§ é…ç½®ç®¡ç†**: ç»Ÿä¸€çš„é…ç½®ç®¡ç†å’Œç¯å¢ƒå˜é‡
- **ğŸ“Š æ—¥å¿—ç³»ç»Ÿ**: ç»“æ„åŒ–æ—¥å¿—å’Œè¯·æ±‚è¿½è¸ª

## ğŸ” å·²çŸ¥é—®é¢˜

### Gemini 2.5æ€è€ƒæœºåˆ¶
- **ç°è±¡**: éƒ¨åˆ†è¯·æ±‚è¿”å› `content: null`
- **åŸå› **: `thoughtsTokenCount` è¿‡é«˜ï¼Œå ç”¨å¤§éƒ¨åˆ†token
- **è§£å†³æ–¹æ¡ˆ**:
  1. ä½¿ç”¨ `enableThoughts: false` å‚æ•°
  2. åˆ‡æ¢åˆ° `gemini-1.5-flash` æ¨¡å‹
  3. è°ƒæ•´ `max_tokens` å‚æ•°

### æ€§èƒ½è¡¨ç°
- **å“åº”æ—¶é—´**: 2-10ç§’ï¼ˆæ­£å¸¸èŒƒå›´ï¼‰
- **æˆåŠŸç‡**: 77%ï¼ˆæœ¬åœ°æµ‹è¯•ç»“æœï¼‰
- **è´Ÿè½½å‡è¡¡**: æ­£å¸¸å·¥ä½œï¼ŒAPI Keyè½®è¯¢æ­£ç¡®

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æºã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

### è´¡çŒ®æŒ‡å—
1. Fork é¡¹ç›®åˆ°æ‚¨çš„GitHubè´¦æˆ·
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“ æ”¯æŒ

å¦‚éœ€å¸®åŠ©ï¼Œè¯·ï¼š
1. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£å’Œæµ‹è¯•æŒ‡å—
2. æäº¤ Issue æè¿°å…·ä½“é—®é¢˜
3. æä¾›æµ‹è¯•æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯

---

**æ³¨æ„**:
- è¯·å°† `<YOUR_DEPLOYED_DOMAIN>` æ›¿æ¢ä¸ºæ‚¨çš„å®é™…éƒ¨ç½²åŸŸå
- è¯·å°† `<YOUR_GEMINI_API_KEY>` æ›¿æ¢ä¸ºæ‚¨çš„å®é™…API Key
- å»ºè®®ä½¿ç”¨ `refactor-architecture` åˆ†æ”¯è·å–æœ€æ–°åŠŸèƒ½
