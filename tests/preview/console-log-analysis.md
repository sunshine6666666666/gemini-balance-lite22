# PreviewçŽ¯å¢ƒConsole.logåˆ†æžæŒ‡å—

## ðŸŽ¯ Console.logè§‚å¯Ÿé‡ç‚¹

### ðŸ“‹ æ—¥å¿—æ ¼å¼æ ‡å‡†
æ‰€æœ‰æ—¥å¿—éƒ½åº”éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š
```
[æ–‡ä»¶ï¼šfilename.js][ä¸­æ–‡æ¨¡å—å][å‡½æ•°å][ReqID:${reqId}] [æ­¥éª¤ X] å…·ä½“ä¿¡æ¯
```

### ðŸ” å…³é”®è§‚å¯Ÿç‚¹

#### 1. è¯·æ±‚å…¥å£å’Œè·¯ç”±
**æ–‡ä»¶**: `api/vercel_index.js`
**è§‚å¯Ÿå†…å®¹**:
```
[æ–‡ä»¶ï¼švercel_index.js][è¾¹ç¼˜å‡½æ•°å…¥å£][handler][ReqID:xxx] [æ­¥éª¤ 1] æ”¶åˆ°è¯·æ±‚: GET/POST /path
[æ–‡ä»¶ï¼švercel_index.js][è¾¹ç¼˜å‡½æ•°å…¥å£][handler][ReqID:xxx] [æ­¥éª¤ 1.1] æ‹¦æˆªé™æ€æ–‡ä»¶è¯·æ±‚: /favicon.ico
[æ–‡ä»¶ï¼švercel_index.js][è¾¹ç¼˜å‡½æ•°å…¥å£][handler][ReqID:xxx] [æ­¥éª¤ 2] è·¯ç”±åˆ°æ ¸å¿ƒå¤„ç†å™¨
```

#### 2. GeminiåŽŸç”ŸAPIå¤„ç†
**æ–‡ä»¶**: `src/gemini-handler.js`
**è§‚å¯Ÿå†…å®¹**:
```
[æ–‡ä»¶ï¼šgemini-handler.js][Geminiå¤„ç†å™¨][handleRequest][ReqID:xxx] [æ­¥éª¤ 1] å¼€å§‹å¤„ç†Gemini APIè¯·æ±‚
[æ–‡ä»¶ï¼šgemini-handler.js][Geminiå¤„ç†å™¨][handleRequest][ReqID:xxx] [æ­¥éª¤ 2] å¼€å§‹API KeyéªŒè¯
[æ–‡ä»¶ï¼šgemini-handler.js][Geminiå¤„ç†å™¨][handleRequest][ReqID:xxx] [æ­¥éª¤ 3] ä½¿ç”¨API Key: AIzaSyXXX... å‘é€è¯·æ±‚
[æ–‡ä»¶ï¼šgemini-handler.js][Geminiå¤„ç†å™¨][handleRequest][ReqID:xxx] [æ­¥éª¤ 4.1][SUCCESS] APIè¯·æ±‚æˆåŠŸï¼ŒçŠ¶æ€: 200
```

#### 3. OpenAIå…¼å®¹APIå¤„ç†
**æ–‡ä»¶**: `src/openai-adapter.js`
**è§‚å¯Ÿå†…å®¹**:
```
[æ–‡ä»¶ï¼šopenai-adapter.js][OpenAIé€‚é…å™¨][handleCompletions][ReqID:xxx] [æ­¥éª¤ 1] å¼€å§‹OpenAIåˆ°Geminiæ ¼å¼è½¬æ¢
[æ–‡ä»¶ï¼šopenai-adapter.js][OpenAIé€‚é…å™¨][handleCompletions][ReqID:xxx] [æ­¥éª¤ 1.2] æ¶ˆæ¯è½¬æ¢å®Œæˆï¼Œå…±Xæ¡
[æ–‡ä»¶ï¼šopenai-adapter.js][OpenAIé€‚é…å™¨][handleCompletions][ReqID:xxx] [æ­¥éª¤ 3][SUCCESS] æ ¼å¼è½¬æ¢å®Œæˆ
```

#### 4. è´Ÿè½½å‡è¡¡æœºåˆ¶
**æ–‡ä»¶**: `src/core/load-balancer.js`
**è§‚å¯Ÿå†…å®¹**:
```
[æ–‡ä»¶ï¼šload-balancer.js][è´Ÿè½½å‡è¡¡å™¨][selectApiKeyBalanced][ReqID:xxx] æ—¶é—´çª—å£: X, é€‰ä¸­ç´¢å¼•: Y
[æ–‡ä»¶ï¼šload-balancer.js][è´Ÿè½½å‡è¡¡å™¨][selectApiKeyBalanced][ReqID:xxx] é€‰ä¸­API Key: AIzaSyXXX...
```

#### 5. å®‰å…¨éªŒè¯
**æ–‡ä»¶**: `src/core/security.js`
**è§‚å¯Ÿå†…å®¹**:
```
[æ–‡ä»¶ï¼šsecurity.js][å®‰å…¨éªŒè¯å™¨][validateTrustedApiKey][ReqID:xxx] æ£€æŸ¥ç™½åå•é…ç½®
[æ–‡ä»¶ï¼šsecurity.js][å®‰å…¨éªŒè¯å™¨][validateTrustedApiKey][ReqID:xxx] API KeyéªŒè¯å¤±è´¥: AIzaSyXXX...
[æ–‡ä»¶ï¼šsecurity.js][å®‰å…¨éªŒè¯å™¨][getEffectiveApiKeys][ReqID:xxx] ä½¿ç”¨å¤‡ç”¨API Keyæ± 
```

#### 6. APIå®¢æˆ·ç«¯è°ƒç”¨
**æ–‡ä»¶**: `src/core/api-client.js`
**è§‚å¯Ÿå†…å®¹**:
```
[æ–‡ä»¶ï¼šapi-client.js][APIå®¢æˆ·ç«¯][enhancedFetch][ReqID:xxx] å‘é€è¯·æ±‚åˆ°: https://generativelanguage.googleapis.com/...
[æ–‡ä»¶ï¼šapi-client.js][APIå®¢æˆ·ç«¯][enhancedFetch][ReqID:xxx] è¯·æ±‚è€—æ—¶: Xms, çŠ¶æ€: 200
[æ–‡ä»¶ï¼šapi-client.js][APIå®¢æˆ·ç«¯][enhancedFetch][ReqID:xxx] [ERROR] è¯·æ±‚å¤±è´¥: timeout
```

### ðŸš¨ é‡ç‚¹å…³æ³¨çš„é—®é¢˜

#### 1. Gemini 2.5æ€è€ƒæœºåˆ¶é—®é¢˜
**è§‚å¯ŸæŒ‡æ ‡**:
```json
{
  "candidates": [{
    "content": {
      "parts": [],  // ç©ºæ•°ç»„è¡¨ç¤ºæ²¡æœ‰å®žé™…è¾“å‡º
      "role": "model"
    },
    "finishReason": "MAX_TOKENS",
    "thoughtsTokenCount": 999,  // å¤§éƒ¨åˆ†tokenç”¨äºŽæ€è€ƒ
    "candidatesTokenCount": 0   // å®žé™…è¾“å‡ºtokenä¸º0
  }]
}
```

**é—®é¢˜è¡¨çŽ°**:
- OpenAIæ ¼å¼å“åº”ä¸­ `content: null`
- çŠ¶æ€ç 200ä½†æ²¡æœ‰å®žé™…å†…å®¹
- `thoughtsTokenCount` æŽ¥è¿‘ `max_tokens`

#### 2. è´Ÿè½½å‡è¡¡éªŒè¯
**éªŒè¯æ–¹æ³•**: è¿žç»­å‘é€å¤šä¸ªè¯·æ±‚ï¼Œè§‚å¯ŸAPI Keyé€‰æ‹©
**æœŸæœ›ç»“æžœ**: ä¸åŒè¯·æ±‚ä½¿ç”¨ä¸åŒçš„API Keyï¼ˆæ—¶é—´çª—å£è½®è¯¢ï¼‰

#### 3. é”™è¯¯å¤„ç†éªŒè¯
**å¸¸è§é”™è¯¯åœºæ™¯**:
- JSONè§£æžé”™è¯¯
- API KeyéªŒè¯å¤±è´¥
- ç½‘ç»œè¶…æ—¶
- æ— æ•ˆç«¯ç‚¹

**è§‚å¯Ÿé‡ç‚¹**: é”™è¯¯æ˜¯å¦è¢«æ­£ç¡®æ•èŽ·å’Œè®°å½•

### ðŸ“Š æ€§èƒ½æŒ‡æ ‡è§‚å¯Ÿ

#### å“åº”æ—¶é—´
- **æ­£å¸¸èŒƒå›´**: 2-10ç§’
- **è­¦å‘ŠèŒƒå›´**: 10-20ç§’
- **å¼‚å¸¸èŒƒå›´**: >20ç§’

#### æˆåŠŸçŽ‡
- **ä¼˜ç§€**: >95%
- **è‰¯å¥½**: 90-95%
- **éœ€ä¼˜åŒ–**: <90%

#### è´Ÿè½½åˆ†å¸ƒ
- **ç†æƒ³çŠ¶æ€**: API Keyä½¿ç”¨å‡åŒ€åˆ†å¸ƒ
- **å¼‚å¸¸çŠ¶æ€**: æŸä¸ªKeyä½¿ç”¨è¿‡å¤š

### ðŸ”§ é—®é¢˜è¯Šæ–­æŒ‡å—

#### å¦‚æžœçœ‹åˆ° `content: null`
1. æ£€æŸ¥ `thoughtsTokenCount` æ˜¯å¦è¿‡é«˜
2. æ£€æŸ¥ `max_tokens` è®¾ç½®æ˜¯å¦åˆç†
3. è€ƒè™‘ä½¿ç”¨ `gemini-1.5-flash` æ›¿ä»£ `gemini-2.5-flash`

#### å¦‚æžœçœ‹åˆ°è´Ÿè½½å‡è¡¡ä¸å·¥ä½œ
1. æ£€æŸ¥æ—¶é—´çª—å£è®¡ç®—æ˜¯å¦æ­£ç¡®
2. éªŒè¯API Keyæ•°ç»„æ˜¯å¦æ­£ç¡®ä¼ é€’
3. è§‚å¯Ÿé€‰ä¸­ç´¢å¼•çš„å˜åŒ–

#### å¦‚æžœçœ‹åˆ°é¢‘ç¹é”™è¯¯
1. æ£€æŸ¥API Keyæ˜¯å¦æœ‰æ•ˆ
2. éªŒè¯ç½‘ç»œè¿žæŽ¥ç¨³å®šæ€§
3. æ£€æŸ¥è¯·æ±‚æ ¼å¼æ˜¯å¦æ­£ç¡®

### ðŸ“ æµ‹è¯•åŽåˆ†æžæ¨¡æ¿

```
## Console.logåˆ†æžæŠ¥å‘Š

### åŸºç¡€åŠŸèƒ½
- [ ] å¥åº·æ£€æŸ¥æ­£å¸¸
- [ ] è·¯ç”±å¤„ç†æ­£ç¡®
- [ ] é™æ€æ–‡ä»¶è¿‡æ»¤å·¥ä½œ

### APIåŠŸèƒ½
- [ ] OpenAIå…¼å®¹APIæ­£å¸¸
- [ ] GeminiåŽŸç”ŸAPIæ­£å¸¸
- [ ] æ¨¡åž‹åˆ—è¡¨è¿”å›žæ­£ç¡®

### è´Ÿè½½å‡è¡¡
- [ ] API Keyè½®è¯¢å·¥ä½œ
- [ ] æ—¶é—´çª—å£è®¡ç®—æ­£ç¡®
- [ ] è´Ÿè½½åˆ†å¸ƒå‡åŒ€

### å®‰å…¨æœºåˆ¶
- [ ] ç™½åå•éªŒè¯æ­£å¸¸
- [ ] API Keyè„±æ•æ˜¾ç¤º
- [ ] é”™è¯¯å¤„ç†ä¼˜é›…

### æ€§èƒ½è¡¨çŽ°
- å¹³å‡å“åº”æ—¶é—´: Xç§’
- æˆåŠŸçŽ‡: X%
- å‘çŽ°çš„é—®é¢˜: [åˆ—å‡ºå…·ä½“é—®é¢˜]

### éœ€è¦ä¼˜åŒ–çš„åœ°æ–¹
1. [å…·ä½“é—®é¢˜1]
2. [å…·ä½“é—®é¢˜2]
3. [å…·ä½“é—®é¢˜3]
```
